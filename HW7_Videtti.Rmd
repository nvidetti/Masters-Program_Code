---
title: "HW7_Videtti"
output: word_document
---
```{r}
##3. Run cor.test() on the correlation between “area” and “perm” in the rock data set and interpret the results. Note that you will have to use the “$” accessor to get at each of the two variables (like this: rock$area). Make sure that you interpret both the confidence interval and the p-value that is generated by cor.test().

?rock
#area = area in pores space, in pixels out of 256 by 256
#perm = permeability in milli-Darcies
head(rock)
cor.test(rock$area,rock$perm)

#First, we see that our alternative hypothesis is that the true correlation between area and perm is not equal to 0, meaning that our null hypothesis is that the true correlation between area and perm is equal to 0.
#We see that the 95% confidence interval ranges from -0.6118206 to -0.1267915. Note that this interval is all negative values, more importantly that it does not contain 0. We also see that the p-value is 0.005254, which is less than 0.05. For these reasons, we have significant evidence to reject the null hypothesis.








##4. Create a copy of the bfCorTest() custom function presented in this chapter. Don’t forget to “source” it (meaning that you have to run the code that defines the function one time to make R aware of it). Conduct a Bayesian analysis of the correlation between “area” and “perm” in the rock data set.

library(BayesFactor)
bfCorTest <- function (x,y) # Get r from BayesFactor 
{ zx <-scale(x) # Standardize X
zy <- scale(y) # Standardize Y 
zData <- data.frame(x=zx,rhoNot0=zy) # Put in a data frame 
bfOut <- generalTestBF(x ~ rhoNot0, data=zData) # linear coefficient 
mcmcOut <- posterior(bfOut,iterations=10000) # posterior samples   
print(summary(mcmcOut[,"rhoNot0"])) # Show the HDI for r 
return(bfOut) # Return Bayes factor object 
} 

bfCorTest(rock$area,rock$perm)

#Point estimate for actual correlation (rho) is -0.345602.
#95% HDI ranges from -0.61771 to -0.08464. Note that this interval does not contain 0.
#Bayes factor is 8.072781, meaning that there are approximately 8:1 odds in favor of the alternative hypothesis. Using a rule of thumb odds cutoff value of 3:1, this is significant odds in favor of the alternative hypothesis.

#All these things considered (more specifically the 95% HDI and Bayes factor), we have significant evidence to reject the null hypothesis that the correlation between rock$area and rock$perm is 0. That is, we can say that there is a nonzero correlation between rock$area and rock$perm.






##8. Not unexpectedly, there is a data set in R that contains these data. The data set is called UCBAdmissions and you can access the department mentioned above like this: UCBAdmissions[, ,1]. Make sure you put two commas before the 1: this is a three dimensional contingency table that we are subsetting down to two dimensions. Run chisq.test() on this subset of the data set and make sense of the results.


UCBAdmissions[,,1]
chisq.test(UCBAdmissions[,,1])
#Chi-squared value is 16.372
#Since we have 2 rows and 2 columns, we have (2-1)*(2-1) = 1 degree of freedom.
#We have a very low p-value of 0.00005205, meaning we would reject the null hypothesis that admissions are independent of gender. That is, we have significant evidence to say that admissions and gender are not independent.







##9. Use contingencyTableBF() to conduct a Bayes factor analysis on the UCB admissions data. Report and interpret the Bayes factor.


contingencyTableBF(UCBAdmissions[,,1],'poisson')

#The Bayes factor is 1111.64, meaning that there are 1111.64:1 odds in favor of the alternative hypothesis that admissions and gender are not independent. Since these odds are more favorable than 3:1, we can choose to reject the null hypothesis, meaning that we can say that admissions and gender are not independent.








##10. Using the UCBA data, run contingencyTableBF() with posterior sampling. Use the results to calculate a 95% HDI of the difference in proportions between the columns.


Exercise10 <- contingencyTableBF(UCBAdmissions[,,1],'poisson',posterior = TRUE,iterations = 10000)
summary(Exercise10)
MaleProp <- Exercise10[,"lambda[1,1]"]/Exercise10[,"lambda[2,1]"]
FemaleProp <- Exercise10[,"lambda[1,2]"]/Exercise10[,"lambda[2,2]"]
GenderProp <- MaleProp - FemaleProp
quantile(GenderProp,0.025)
quantile(GenderProp,0.975)

#Thus, our 95% HDI of the difference in proportions between the Male and Female columns ranges from -6.005852 and -1.200246.







```